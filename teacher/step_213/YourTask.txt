Возможный план реализации проблемы повторяющейся выгрузки
агриментов в xml export джобе:

1. Создать в базе данных таблицу agreements_xml_export
со следующими колонками:
- id (BIGINT)
- agreement_uuid (VARCHAR(255))
- already_exported (BOOL)

Идея состоит в том, чтобы при выгрузке агримента в xml файл в базе
данных сохранять отметку о выгрузке для того, чтобы повторно не
выгружать один и тот же агримент.

Для создания таблицы воспользуемся Liquibase в приложении и SQL в тестах.

2. Создать доменный объект AgreementXmlExportEntity
и его интерфейс репозиторий. Он будет нужен для сохранения объектов
в базу данных.

3. Переименовать TravelGetAllAgreementUuidsCoreCommand
в TravelGetNotExportedAgreementUuidsCoreCommand (соответственно
переименовать класс ответа и сам core сервис). Внутри сервиса
поменять логику с доставания из базы всех агримент uuids на
подтягивание только ранее не выгруженных агримент uuids. Для этого
нужно будет написать свой SQL запрос.

4. При выгрузке агримента в xml файл теперь нужно еще
и сохранять об этом информацию в базе данных. А сохранять
данные в базу данных по архитектуре правильно в core. Поэтому
AgreementXmlExporter нужно перенести в core. Для этого надо
создать новую core команду с классом ответа и сервисом.
Например: TravelExportAgreementToXmlCoreCommand.

5. Перенести всю логику из AgreementXmlExporter в core сервис
TravelExportAgreementToXmlCoreCommand разобравшись при этом
с ошибками. При возникновении ошибки обязательно ее логируем в лог,
плюс создаем новый код ошибки и возвращаем ошибку через класс ответа.

6. Добавляем в TravelExportAgreementToXmlCoreCommand логику по
сохранению объекта AgreementXmlExportEntity в базу данных.


Перед тем как приступить к реализации этого плана попробуйте
ответить на вопрос: почему в плане предлагается создать новую
таблицу для хранения признака выгрузки агримента в xml файл,
а не просто добавить новую колонку в уже существующую таблицу
агриментов? Если вы не можете найти ответ на этот вопрос самостоятельно,
обсудите его с другими участниками проекта и ментором.

Ваша задача: реализовать предложенный выше план.

PS: не забудьте по окончанию выполнения шага создать и заполнить
файл /documentation/Step_X_description.txt. Формат заполнения этого
файла описан в step_1 в файле Learning_reflection.txt.